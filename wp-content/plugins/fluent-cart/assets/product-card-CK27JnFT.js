var I=Object.defineProperty;var V=n=>{throw TypeError(n)};var R=(n,t,e)=>t in n?I(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var E=(n,t,e)=>R(n,typeof t!="symbol"?t+"":t,e),b=(n,t,e)=>t.has(n)||V("Cannot "+e);var d=(n,t,e)=>(b(n,t,"read from private field"),e?e.call(n):t.get(n)),p=(n,t,e)=>t.has(n)?V("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),l=(n,t,e,a)=>(b(n,t,"write to private field"),a?a.call(n,e):t.set(n,e),e),f=(n,t,e)=>(b(n,t,"access private method"),e);class j{static init(){document.addEventListener("click",function(t){var w;const e=t.target.closest("[data-fluent-cart-add-to-cart-button]");if(!e||(t.preventDefault(),e.classList.contains("fct-loading")))return;e.classList.add("fct-loading");const a=e.getAttribute("data-cart-id");if(!a)return;let s=parseInt(e.getAttribute("data-quantity"),10)||1;const o=e.getAttribute("data-action-name"),u=e.getAttribute("data-error-action-name");e.setAttribute("data-quantity","1"),(w=window.fluentCartCart)==null||w.addProduct(a,s,!1,!0).then(h=>{setTimeout(()=>{e.classList.remove("fct-loading")},300),document.dispatchEvent(new Event(o))}).catch(h=>{console.log(h,"error"),e.classList.remove("fct-loading"),document.dispatchEvent(new Event(u))})})}}class H{static init(){document.addEventListener("click",function(t){const e=window.FluentCartSingleProductModal;if(!e)return;const a=t.target.closest("[data-fluent-cart-product-details-button]");if(a){t.preventDefault();const s=a.getAttribute("data-product-id");e.openModal(s,a)}})}}var m,C,M,v,r,c,U,B,N,P,O,D,$,x;const i=class i{constructor(){p(this,c);p(this,m,!1);p(this,C,window.fluentCartRestVars.rest.url);p(this,M,"/public/single-product-views");p(this,v,700);p(this,r,null);f(this,c,B).call(this),f(this,c,D).call(this),f(this,c,N).call(this)}async openModal(t,e){var S,T;const a=this;if(d(a,m))return;l(a,m,!0),e&&e.classList.add("loading");let s=document.createElement("div"),o=document.createElement("div");o.className="fluent-cart-shop-app-single-product-modal",o.setAttribute("data-fluent-cart-shop-app-single-product-modal","");const u=document.createElement("div");u.className="fluent-cart-shop-app-single-product-modal-overlay",u.setAttribute("data-fluent-cart-shop-app-single-product-modal-overlay",""),o.appendChild(u);const w=document.createElement("div");w.className="fluent-cart-shop-app-single-product-modal-body";const h=document.createElement("div");h.className="fct-cart-drawer-loader show",h.setAttribute("data-fluent-cart-cart-drawer-loader","");const k=document.createElement("div");k.className="fct-cart-drawer-loader-spin-wrap",h.appendChild(k),w.appendChild(h),o.appendChild(w),s.style.opacity="1",s.style.pointerEvents="auto",s.appendChild(o),document.body.appendChild(s),l(a,r,o);const q=await f(S=a,c,O).call(S,t);q&&(o.innerHTML=q,l(a,r,o),f(this,c,$).call(this,o,d(a,v)),f(T=a,c,P).call(T,o),window.dispatchEvent(new CustomEvent("fluentCartSingleProductModalOpened",{detail:{productId:t}}))),document.body.style.overflow="hidden"}closeModal(t){f(this,c,x).call(this,t,d(this,v),()=>{t.remove(),document.body.style.overflow="",l(this,r,null)})}};m=new WeakMap,C=new WeakMap,M=new WeakMap,v=new WeakMap,r=new WeakMap,c=new WeakSet,U=function(){const t=document.querySelector("[data-fluent-cart-shop-app-single-product-modal-close]"),e=document.querySelector(".fluent-cart-shop-app-single-product-modal-body");if(t&&e){const a=()=>{const s=e.getBoundingClientRect(),o=e.scrollTop;t.style.right=`${window.innerWidth-s.right+5}px`,t.style.top=`${s.top+5}px`,o>=100?t.classList.add("hovered"):t.classList.remove("hovered")};a(),e.addEventListener("scroll",a),window.addEventListener("resize",a),window.addEventListener("scroll",a)}},B=function(){const t=this;document.addEventListener("click",async function(e){const a=e.target.closest("[data-fluent-cart-single-product-card-view-button]");if(!a)return;a.classList.add("fct-loading");const s=a.dataset.productId;await t.openModal(s,a),a.classList.remove("fct-loading")})},N=function(){const t=this;document.addEventListener("keydown",function(e){e.key==="Escape"&&d(t,r)&&d(t,r).querySelector("[data-fluent-cart-shop-app-single-product-modal]")&&t.closeModal(d(t,r))})},P=function(t){t.querySelectorAll("[data-fluent-cart-single-product-page]").forEach(a=>{new window.FluentCartSingleProduct().init(a,0)})},O=async function(t){if(i.cachedView[t])return l(this,m,!1),i.cachedView[t];l(this,m,!0);const{request:e,controller:a}=window.fluentCartAjax.get({action:"fluent_cart_checkout_routes",fc_checkout_action:"get_product_modal_view",product_id:t},!0),o=(await e).view;i.cachedView[t]=o;const u=Object.keys(i.cachedView);return u.length>i.cacheThreshold&&delete i.cachedView[u[0]],l(this,m,!1),o},D=function(){const t=this;document.addEventListener("click",function(e){const a=document.querySelector("[data-fluent-cart-shop-app-single-product-modal-overlay]"),s=document.querySelector("[data-fluent-cart-shop-app-single-product-modal-close]"),o=e.target.closest("[data-fluent-cart-shop-app-single-product-modal]");a&&a.contains(e.target)&&t.closeModal(o.parentElement),s&&s.contains(e.target)&&t.closeModal(o.parentElement)})},$=function(t,e){t.style.opacity="0",t.style.transition=`opacity ${e}ms ease-in-out`,t.offsetHeight,t.style.opacity="1",setTimeout(()=>{t.style.pointerEvents="auto"},e)},x=function(t,e,a){t.style.transition=`opacity ${e}ms ease-in-out`,t.style.opacity="0",setTimeout(()=>{a&&a()},e)},E(i,"cachedView",{}),E(i,"cacheThreshold",10);let L=i;var y;const g=class g{static init(){return d(g,y)!==null?d(g,y):(j.init(),H.init(),l(g,y,this),this)}};y=new WeakMap,p(g,y,null);let A=g;window.addEventListener("load",function(){A.init(),window.FluentCartSingleProductModal=new L});
